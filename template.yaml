AWSTemplateFormatVersion: 2010-09-09
Metadata:
  'AWS::CloudFormation::Designer':
    83453b04-7644-4097-9f67-f65cd55e29a4:
      size:
        width: 2550
        height: 1200
      position:
        x: 30
        'y': 240
      z: 1
      embeds:
        - cf4abe3e-4e86-419c-ba19-30e77b475d89
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
        - 605d8cb5-3c5d-494f-b917-941fb7c787ad
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - f17fb5a9-9ee5-493e-bfd7-0ecd88a9d6fc
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 6ffe7d8f-706d-477c-abb6-5804e99061fe
        - df4a2a8d-57ec-470f-9d4b-2fe143094311
    505abc1b-744b-4f1c-ac1d-4593ee0c8f7d:
      size:
        width: 900
        height: 300
      position:
        x: 480
        'y': 270
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds:
        - 233f632d-b924-4fdf-b4a4-0e5876a405d3
        - 00b8a74f-7587-43c3-a659-60ef9014da8a
      iscontainedinside:
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
    7956d3bf-0411-47c3-a791-53af78c3db0e:
      size:
        width: 900
        height: 300
      position:
        x: 480
        'y': 600
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds:
        - 5265c801-0cd5-458e-8219-b108dd48d189
        - 2a658f03-e462-422f-b8d8-6abc59b74be2
      iscontainedinside:
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
    df4a2a8d-57ec-470f-9d4b-2fe143094311:
      size:
        width: 60
        height: 60
      position:
        x: 330
        'y': 540
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds: []
      iscontainedinside:
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
    6ffe7d8f-706d-477c-abb6-5804e99061fe:
      size:
        width: 60
        height: 60
      position:
        x: 60
        'y': 540
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds: []
    cf4abe3e-4e86-419c-ba19-30e77b475d89:
      size:
        width: 60
        height: 60
      position:
        x: 180
        'y': 540
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds: []
    f17fb5a9-9ee5-493e-bfd7-0ecd88a9d6fc:
      size:
        width: 60
        height: 60
      position:
        x: 180
        'y': 300
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds: []
      iscontainedinside:
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
    00b8a74f-7587-43c3-a659-60ef9014da8a:
      size:
        width: 60
        height: 60
      position:
        x: 480
        'y': 330
      z: 3
      parent: 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
      embeds: []
      iscontainedinside:
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
    5265c801-0cd5-458e-8219-b108dd48d189:
      size:
        width: 60
        height: 60
      position:
        x: 480
        'y': 660
      z: 3
      parent: 7956d3bf-0411-47c3-a791-53af78c3db0e
      embeds: []
      iscontainedinside:
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
    2a658f03-e462-422f-b8d8-6abc59b74be2:
      size:
        width: 60
        height: 60
      position:
        x: 480
        'y': 780
      z: 3
      parent: 7956d3bf-0411-47c3-a791-53af78c3db0e
      embeds: []
      iscontainedinside:
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
        - 7956d3bf-0411-47c3-a791-53af78c3db0e
    233f632d-b924-4fdf-b4a4-0e5876a405d3:
      size:
        width: 60
        height: 60
      position:
        x: 480
        'y': 450
      z: 3
      parent: 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
      embeds: []
      iscontainedinside:
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
        - 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
    c1c92124-f585-41a6-954c-581e8bb5d568:
      size:
        width: 360
        height: 270
      position:
        x: 90
        'y': 870
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds:
        - ebd3af38-b1c7-4fd9-910c-c7dc01a0c33a
        - 5547d8e7-fe85-45cf-848a-7a61f8275227
      iscontainedinside:
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
    cf3cab38-1e40-4f58-8ce0-1dc1897e49d7:
      source:
        id: 83453b04-7644-4097-9f67-f65cd55e29a4
      target:
        id: cf3cab38-1e40-4f58-8ce0-1dc1897e49d7
      z: 2
    ebd3af38-b1c7-4fd9-910c-c7dc01a0c33a:
      size:
        width: 60
        height: 60
      position:
        x: 90
        'y': 1020
      z: 3
      parent: c1c92124-f585-41a6-954c-581e8bb5d568
      embeds: []
      isassociatedwith:
        - 605d8cb5-3c5d-494f-b917-941fb7c787ad
      iscontainedinside:
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
        - c1c92124-f585-41a6-954c-581e8bb5d568
    605d8cb5-3c5d-494f-b917-941fb7c787ad:
      size:
        width: 60
        height: 60
      position:
        x: 240
        'y': 1140
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds: []
      iscontainedinside:
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
    dc6544b8-7f9e-4682-a124-42d4ae0169e2:
      size:
        width: 330
        height: 270
      position:
        x: 690
        'y': 1050
      z: 2
      parent: 83453b04-7644-4097-9f67-f65cd55e29a4
      embeds:
        - 36f78031-a125-460e-ad8f-f4cbee43e772
      iscontainedinside:
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
        - 83453b04-7644-4097-9f67-f65cd55e29a4
    36f78031-a125-460e-ad8f-f4cbee43e772:
      size:
        width: 60
        height: 60
      position:
        x: 690
        'y': 1140
      z: 3
      parent: dc6544b8-7f9e-4682-a124-42d4ae0169e2
      embeds: []
      isassociatedwith:
        - cf3cab38-1e40-4f58-8ce0-1dc1897e49d7
      iscontainedinside:
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
        - dc6544b8-7f9e-4682-a124-42d4ae0169e2
    789eb931-c612-4eeb-b34f-7d2dd0abf30c:
      source:
        id: dc6544b8-7f9e-4682-a124-42d4ae0169e2
      target:
        id: c1c92124-f585-41a6-954c-581e8bb5d568
      z: 2
    5547d8e7-fe85-45cf-848a-7a61f8275227:
      size:
        width: 60
        height: 60
      position:
        x: 185.41567108557953
        'y': 948.1789536809562
      z: 3
      parent: c1c92124-f585-41a6-954c-581e8bb5d568
      iscontainedinside:
        - c1c92124-f585-41a6-954c-581e8bb5d568
Resources:
  PrivateChain:
    Type: 'AWS::EC2::VPC'
    Properties:
      CidrBlock: 10.1.0.0/24
      Tags:
        - Key: Name
          Value: PrivateChain
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 83453b04-7644-4097-9f67-f65cd55e29a4
  PrivateSubNet1:
    Type: 'AWS::EC2::Subnet'
    Properties:
      VpcId: !Ref PrivateChain
      CidrBlock: 10.1.0.0/28
      AvailabilityZone: ap-northeast-1a
      Tags:
        - Key: Name
          Value: PrivateSubNet1
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 505abc1b-744b-4f1c-ac1d-4593ee0c8f7d
  PrivateSubNet2:
    Type: 'AWS::EC2::Subnet'
    Properties:
      VpcId: !Ref PrivateChain
      CidrBlock: 10.1.0.16/28
      AvailabilityZone: ap-northeast-1c
      Tags:
        - Key: Name
          Value: PrivateSubNet2
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 7956d3bf-0411-47c3-a791-53af78c3db0e
  ELB:
    Type: 'AWS::ElasticLoadBalancing::LoadBalancer'
    Properties:
      LoadBalancerName: ELB
      Scheme: internal
      Subnets:
        - !Ref PrivateSubNet1
        - !Ref PrivateSubNet2
      Listeners:
        - LoadBalancerPort: '80'
          InstancePort: '80'
          Protocol: HTTP
          InstanceProtocol: HTTP
      Tags:
        - Key: Name
          Value: ELB
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: df4a2a8d-57ec-470f-9d4b-2fe143094311
  RoleToELB:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - lambda.amazonaws.com
            Action:
              - 'sts:AssumeRole'
      Policies:
        - PolicyName: ELBFullAccess
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action: '*'
                Resource: '*'
    Metadata:
      'AWS::CloudFormation::Designer':
        id: cf4abe3e-4e86-419c-ba19-30e77b475d89
  GetBalance:
    Type: 'AWS::Lambda::Function'
    Properties:
      Runtime: python3.6
      Code:
        ZipFile: ./tmp.zip
      Handler: handler.lambda_handler
      Role: !GetAtt RoleToELB.Arn
      VpcConfig:
        SecurityGroupIds:
          - !Ref PrivateSecurityGroup
        SubnetIds:
          - !Ref PrivateSubNet1
          - !Ref PrivateSubNet2
      Tags:
        - Key: Name
          Value: GetBalance
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 6ffe7d8f-706d-477c-abb6-5804e99061fe
  PrivateSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !Ref PrivateChain
      GroupName: PrivateSecurityGroup
      GroupDescription: Security Group for Private chain.
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: '30300'
          ToPort: '30300'
          CidrIp: 10.1.0.0/24
          Description: 'For enodes.'
      Tags:
        - Key: Name
          Value: PrivateSecurityGroup
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: f17fb5a9-9ee5-493e-bfd7-0ecd88a9d6fc
  PCParityPoA1a:
    Type: 'AWS::EC2::Instance'
    Properties:
      ImageId: ami-83f0feff
      SubnetId: !Ref PrivateSubNet1
      KeyName: private-chain
      SecurityGroupIds:
        - !Ref PrivateSecurityGroup
      Tags:
        - Key: Name
          Value: PCParityPoA1a
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 00b8a74f-7587-43c3-a659-60ef9014da8a
  PCParityPoA2a:
    Type: 'AWS::EC2::Instance'
    Properties:
      ImageId: ami-83f0feff
      SubnetId: !Ref PrivateSubNet1
      KeyName: private-chain
      SecurityGroupIds:
        - !Ref PrivateSecurityGroup
      Tags:
        - Key: Name
          Value: PCParityPoA2a
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 233f632d-b924-4fdf-b4a4-0e5876a405d3
  PCParityPoA1c:
    Type: 'AWS::EC2::Instance'
    Properties:
      ImageId: ami-83f0feff
      SubnetId: !Ref PrivateSubNet2
      KeyName: private-chain
      SecurityGroupIds:
        - !Ref PrivateSecurityGroup
      Tags:
        - Key: Name
          Value: PCParityPoA1c
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 2a658f03-e462-422f-b8d8-6abc59b74be2
  PCParityPoA2c:
    Type: 'AWS::EC2::Instance'
    Properties:
      ImageId: ami-83f0feff
      SubnetId: !Ref PrivateSubNet2
      KeyName: private-chain
      SecurityGroupIds:
        - !Ref PrivateSecurityGroup
      Tags:
        - Key: Name
          Value: PCParityPoA2c
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 5265c801-0cd5-458e-8219-b108dd48d189
  PublicSubnet:
    Type: 'AWS::EC2::Subnet'
    Properties:
      VpcId: !Ref PrivateChain
      AvailabilityZone: ap-northeast-1c
      CidrBlock: 10.1.0.32/28
      Tags:
        - Key: Name
          Value: PublicSubnet
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: c1c92124-f585-41a6-954c-581e8bb5d568
  InternetGateway:
    Type: 'AWS::EC2::InternetGateway'
    Properties:
      Tags:
        - Key: Name
          Value: InternetGateway
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: cf3cab38-1e40-4f58-8ce0-1dc1897e49d7
  VPCGatewayAttachment:
    Type: 'AWS::EC2::VPCGatewayAttachment'
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: cf3cab38-1e40-4f58-8ce0-1dc1897e49d7
  Bastion:
    Type: 'AWS::EC2::Instance'
    Properties:
      ImageId: ami-bec974d8
      SubnetId: !Ref PublicSubnet
      KeyName: private-chain
      SecurityGroupIds:
        - !Ref PublicSecurityGroup
      Tags:
        - Key: Name
          Value: Bastion
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: ebd3af38-b1c7-4fd9-910c-c7dc01a0c33a
  EIPAssociation:
    Type: 'AWS::EC2::EIPAssociation'
    Properties:
      AllocationId: eipalloc-4e2c3274
      InstanceId: !Ref Bastion
  PublicSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !Ref PrivateChain
      GroupName: PublicSecurityGroup
      GroupDescription: Security Group for public subnet. Enable SSH access via port 22
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
      Tags:
        - Key: Name
          Value: PublicSecurityGroup
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 605d8cb5-3c5d-494f-b917-941fb7c787ad
  PublicRouteTable:
    Type: 'AWS::EC2::RouteTable'
    Properties:
      VpcId: !Ref PrivateChain
      Tags:
        - Key: Name
          Value: PublicRouteTable
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: dc6544b8-7f9e-4682-a124-42d4ae0169e2
  PublicRoute:
    Type: 'AWS::EC2::Route'
    Properties:
      RouteTableId: !Ref PublicRouteTable
      DestinationCidrBlock: 0.0.0.0/0
      GatewayId: !Ref InternetGateway
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 36f78031-a125-460e-ad8f-f4cbee43e772
  PublicSubnetRouteTableAssociation:
    Type: 'AWS::EC2::SubnetRouteTableAssociation'
    Properties:
      SubnetId: !Ref PublicSubnet
      RouteTableId: !Ref PublicRouteTable
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 789eb931-c612-4eeb-b34f-7d2dd0abf30c
  NatGateway:
    Type: 'AWS::EC2::NatGateway'
    Properties:
      AllocationId: eipalloc-0e273934
      SubnetId: !Ref PublicSubnet
      Tags:
        - Key: Name
          Value: NatGateway
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 5547d8e7-fe85-45cf-848a-7a61f8275227
  PrivateRouteTable:
    Type: 'AWS::EC2::RouteTable'
    Properties:
      VpcId: !Ref PrivateChain
      Tags:
        - Key: Name
          Value: PrivateRouteTable
        - Key: Component
          Value: PrivateChain
    Metadata:
      'AWS::CloudFormation::Designer':
        id: dc6544b8-7f9e-4682-a124-42d4ae0169e2
  PrivateRoute:
    Type: 'AWS::EC2::Route'
    Properties:
      RouteTableId: !Ref PrivateRouteTable
      DestinationCidrBlock: 0.0.0.0/0
      NatGatewayId: !Ref NatGateway
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 36f78031-a125-460e-ad8f-f4cbee43e772
  PrivateSubnetRouteTableAssociation1:
    Type: 'AWS::EC2::SubnetRouteTableAssociation'
    Properties:
      SubnetId: !Ref PrivateSubNet1
      RouteTableId: !Ref PrivateRouteTable
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 789eb931-c612-4eeb-b34f-7d2dd0abf30c
  PrivateSubnetRouteTableAssociation2:
    Type: 'AWS::EC2::SubnetRouteTableAssociation'
    Properties:
      SubnetId: !Ref PrivateSubNet2
      RouteTableId: !Ref PrivateRouteTable
    Metadata:
      'AWS::CloudFormation::Designer':
        id: 789eb931-c612-4eeb-b34f-7d2dd0abf30c
